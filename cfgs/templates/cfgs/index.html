{% extends "base.html" %}
{% block content %}

<style>
.card {
    /* Add shadows to create the "card" effect */
    box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
    transition: 0.3s;
    padding: 2px 16px;
}

/* Add some padding inside the card container */
.container {
    padding: 20px 16px;
}

/* Style the submit button */
input[type=submit] {
  width: 100%;
  background-color: #4CAF50;
  color: white;
  padding: 14px 20px;
  margin: 8px 0;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

/* Add a background color to the submit button on mouse-over */
input[type=submit]:hover {
  background-color: #45a049;
}
</style>

<div class="container">

    <header>
        <form action=""
              method="post">{% csrf_token %}
            {{ cfgs }}
        </form>
    </header>

    {% if cfg is not None %}
    <nav style="position: fixed!important; width:200px; height: 100%; padding-left:10px;">
        {% for i,j in keys %}
        <a style="font-size:16px; font-weight: bold; display:block;" href="/cfgs/{{cfg}}/{{i}}">{{ j }}</a>
        {% endfor %}
    </nav>

    {% if form is not None %}
    {% load material_form %}
    <div style="margin-left:210px;">
        <div class="card">
        <h6 style="font-weight:bold">{{request.path}}</h6>
            <form action="" method="post">

                {% csrf_token %}
                <!--{{ frm }}-->
                {% form form=form %}{% endform %}
                <input type="submit" value="Save">
            </form>
        </div>
    </div>
    {% endif%}

    {% if forms is not None %}
    {% load material_form %}
    <div style="margin-left:210px;">
        {% for frm in forms %}
        <div id="form{{forloop.counter0}}" class="card" style="display:none">
            <h6 style="font-weight:bold">{{request.path}}/{{forloop.counter0}}</h6>
            <form action="" method="post">

                {% csrf_token %}
                <!--{{ frm }}-->
                {% form form=frm %}{% endform %}
                <input type="submit" value="Save">
                <input type="hidden" name="_id" value="{{forloop.counter0}}">
            </form>
        </div>
        {% endfor %}

        <input id="prevbutton" type="button" value="Previous" class="btn blue" />
        <input id="nextbutton" type="button" value="Next" class="btn blue" />
        <input id="removebutton" type="button" class="btn red" value="Remove" />
        <input id="addbutton" type="button" value="Add" class="btn green" />

    </div>

    <script>
        var form_id = 0

        function handleButtons(new_form_id) {
            form_id = new_form_id
            $("div[id^='form']").hide();
            $("#form"+new_form_id).show();

            if (new_form_id>0) $("#prevbutton").show();
            else $("#prevbutton").hide();

            if ($('#form1').length) $("#removebutton").show();
            else $("#removebutton").hide();

            if ($('#form'+(new_form_id+1)).length) {
                $("#nextbutton").show();
                $("#addbutton").hide();
            } else {
                $("#nextbutton").hide();
                $("#addbutton").show();
            }
        }

        $("#prevbutton").click(function (){handleButtons(form_id-1)})
        $("#nextbutton").click(function (){handleButtons(form_id+1)})
        $("#addbutton").click(function() {
            window.location = '{{request.path}}'+'/add';
        })
        $("#removebutton").click(function() {
            window.location = '{{request.path}}'+'/remove/'+form_id;
        })

        handleButtons(form_id)
    </script>

    {% endif %}
    {% endif %}

</div>

{% endblock %}
